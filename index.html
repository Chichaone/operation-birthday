<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stitch Party Challenge</title>
    <link rel="stylesheet" href="./src/App.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-presets="typescript,react">
      const { useEffect, useMemo, useRef, useState } = React;

      type FloatingShape = {
        type: "circle" | "star" | "diamond" | "heart";
        left: string;
        top: string;
        size: number;
        duration: number;
        delay: number;
        opacity?: number;
      };

      const Header: React.FC = () => (
        <header className="text-center mt-8 space-y-3">
          <h1 className="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-wide drop-shadow-sm text-white">
            –í–ï–ß–ï–†–ò–ù–ö–ê STITCH PARTY CHALLENGE
          </h1>
          <p className="text-lg md:text-xl lg:text-2xl text-white/90 leading-snug max-w-2xl mx-auto">
            –°–µ–≥–æ–¥–Ω—è –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è.
            <br />
            –°–µ–≥–æ–¥–Ω—è ‚Äî —Å–∞–º–∞—è –≤–µ—Å—ë–ª–∞—è –≤–µ—á–µ—Ä–∏–Ω–∫–∞ –≥–æ–¥–∞ üíô
          </p>
        </header>
      );

      const Mascot: React.FC = () => (
        <div className="relative flex flex-col items-center">
          <div className="party-mascot-wrapper drop-shadow-2xl">
            {/* –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ public/images/mascot.png */}
            <img src="/images/mascot.png" alt="–ú–∞—Å–∫–æ—Ç –≤–µ—á–µ—Ä–∏–Ω–∫–∏" className="w-60 md:w-72 lg:w-80" />
          </div>
        </div>
      );

      const SpeechBubble: React.FC = () => (
        <div className="party-speech-bubble mt-6 text-base md:text-lg lg:text-xl font-medium max-w-xl text-center">
          –ü—Ä–∏–≤–µ—Ç! –ï—Å–ª–∏ —Ç—ã –∑–¥–µ—Å—å, –∑–Ω–∞—á–∏—Ç —Ç—ã –≥–æ—Ç–æ–≤–∞:
          <br />üî• —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å
          <br />üéØ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è
          <br />üòÇ —Å–º–µ—è—Ç—å—Å—è
          <br />–∏ –ø–æ–ª—É—á–∞—Ç—å —Å—é—Ä–ø—Ä–∏–∑—ã!
        </div>
      );

      const StartButton: React.FC<{ onClick: () => void }> = ({ onClick }) => (
        <div className="mt-8 flex flex-col items-center gap-2">
          {/* onClick –¥–ª—è –∫–Ω–æ–ø–∫–∏ ¬´–ù–ê–ß–ê–¢–¨ –í–ï–ß–ï–†–ò–ù–ö–£¬ª, –∑–¥–µ—Å—å –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º –ø–µ—Ä–µ—Ö–æ–¥ */}
          <button
            onClick={onClick}
            className={`party-start-button px-10 py-4 rounded-full bg-pink-500 hover:bg-pink-400 text-2xl md:text-3xl font-bold uppercase tracking-wide text-white shadow-xl transform`}
          >
            –ù–ê–ß–ê–¢–¨ –í–ï–ß–ï–†–ò–ù–ö–£
          </button>
          <span className="text-white/85 text-lg">–û–±—Ä–∞—Ç–Ω–æ–π –¥–æ—Ä–æ–≥–∏ –Ω–µ—Ç üòé</span>
        </div>
      );

      const MusicToggle: React.FC<{ isPlaying: boolean; onToggle: () => void }> = ({ isPlaying, onToggle }) => (
        <div className="absolute top-4 right-4">
          <button
            onClick={onToggle}
            className={`party-music-toggle px-4 py-2 text-sm md:text-base rounded-full bg-white/20 text-white border border-white/40 shadow-md hover:shadow-lg transition`}
          >
            –ú—É–∑—ã–∫–∞: {isPlaying ? "–≤–∫–ª" : "–≤—ã–∫–ª"}
          </button>
        </div>
      );

      const App: React.FC = () => {
        const audioRef = useRef<HTMLAudioElement | null>(null);
        const [isMusicOn, setIsMusicOn] = useState(false);
        const [isVisible, setIsVisible] = useState(false);

        const floatingShapes = useMemo<FloatingShape[]>(
          () => [
            { type: "circle", left: "8%", top: "10%", size: 10, duration: 16, delay: 0 },
            { type: "star", left: "20%", top: "35%", size: 14, duration: 18, delay: 2 },
            { type: "diamond", left: "70%", top: "15%", size: 12, duration: 15, delay: 1 },
            { type: "circle", left: "85%", top: "30%", size: 18, duration: 20, delay: 3 },
            { type: "heart", left: "50%", top: "20%", size: 16, duration: 17, delay: 1.5 },
            { type: "star", left: "15%", top: "70%", size: 18, duration: 19, delay: 0.5 },
            { type: "diamond", left: "60%", top: "75%", size: 14, duration: 16, delay: 2.5 },
            { type: "circle", left: "75%", top: "55%", size: 12, duration: 18, delay: 0.8 },
            { type: "heart", left: "35%", top: "60%", size: 14, duration: 21, delay: 1.2 },
          ],
          []
        );

        useEffect(() => {
          const timeout = setTimeout(() => setIsVisible(true), 80);
          return () => clearTimeout(timeout);
        }, []);

        const handleToggleMusic = () => {
          const audio = audioRef.current;
          if (!audio) return;

          if (isMusicOn) {
            audio.pause();
            setIsMusicOn(false);
          } else {
            audio
              .play()
              .then(() => setIsMusicOn(true))
              .catch(() => setIsMusicOn(false));
          }
        };

        const handleStart = () => {
          console.log("Start the party clicked");
          // –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (–∫–æ–º–∞–Ω–¥—ã)
        };

        return (
          <div className={`party-background min-h-screen flex flex-col relative overflow-hidden`}>
            {/* –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞—É–¥–∏–æ—Ñ–∞–π–ª –∏–∑ public/audio/intro.mp3 */}
            <audio ref={audioRef} src="/audio/intro.mp3" className="hidden" />

            <div className="party-decorations" aria-hidden={true}>
              {floatingShapes.map((shape, index) => (
                <span
                  key={`${shape.type}-${index}`}
                  className={`party-floating-element party-${shape.type}`}
                  style={{
                    left: shape.left,
                    top: shape.top,
                    width: shape.size,
                    height: shape.size,
                    animationDuration: `${shape.duration}s`,
                    animationDelay: `${shape.delay}s`,
                    opacity: shape.opacity ?? 0.6,
                  }}
                />
              ))}
            </div>

            <MusicToggle isPlaying={isMusicOn} onToggle={handleToggleMusic} />

            <div className={`flex flex-col items-center flex-1 px-4 pb-12 party-fade-in ${isVisible ? "party-fade-in-visible" : ""}`}>
              <Header />

              <main className="flex flex-col items-center justify-center flex-1 w-full">
                <Mascot />
                <SpeechBubble />
                <StartButton onClick={handleStart} />
              </main>
            </div>
          </div>
        );
      };

      const rootElement = document.getElementById("root");
      if (rootElement) {
        ReactDOM.createRoot(rootElement).render(<App />);
      }
    </script>
  </body>
</html>
